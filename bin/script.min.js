!function(){var a=this,b=function(){},c=function(a){return c.get(a)};c.json=function(a){if(!a)return!1;var b=a;return"string"==typeof a&&(b={url:a}),b.method="GET",b.json=!0,new c.request(b)},c.get=function(a){return new c.request(a)},c.post=function(a){if(!a)return!1;var b=a;return"string"==typeof a&&(b={url:a}),b.method="POST",new c.request(b)},c.request=function(a){if(!a)return!1;if(this.xhr=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),this.xhr.options=a,"string"==typeof a&&(this.xhr.options={url:a}),"POST"===this.xhr.options.method){var b="?";for(var c in this.xhr.options.options)b+=this.xhr.options.options.hasOwnProperty(c)?"&"+c+"="+this.xhr.options.options[c]:""}else{this.xhr.options.method="GET",this.xhr.options.url+=this.xhr.options.url.indexOf("?")<0?"?":"";for(var c in this.xhr.options.options)this.xhr.options.url+=this.xhr.options.options.hasOwnProperty(c)?"&"+c+"="+this.xhr.options.options[c]:""}return this.xhr.callbacks={then:[],error:[]},this.then=function(a){return this.xhr.callbacks.then.push(a),this},this.error=function(a){return this.xhr.callbacks.error.push(a),this},this.xhr.returnSuccess=function(a){for(var b=0;b<this.callbacks.then.length;b++)"function"==typeof this.callbacks.then[b]&&this.callbacks.then[b](a)},this.xhr.returnError=function(a){for(var b=0;b<this.callbacks.error.length;b++)"function"==typeof this.callbacks.error[b]&&this.callbacks.error[b](a)},this.xhr.onreadystatechange=function(){if(4===this.readyState&&200==this.status){var a=this.responseText;if(this.options.json)try{a=JSON.parse(a)}catch(b){return this.returnError("invalid json"),!1}this.returnSuccess(a)}else 4===this.readyState&&404==this.status?this.returnError("404"):4===this.readyState&&this.returnError("unknow")},this.xhr.open(this.xhr.options.method,this.xhr.options.url,!0),this.xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.xhr.send("undefined"!=typeof b?b:null),this},a.Application=b}(this);